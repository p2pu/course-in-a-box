<!DOCTYPE html>
<html>

<head>
	<title>Weekly Journal</title>
</head>

<body>
	<h1>Weekly Journal</h1>
	<button id="openJournalForm">Open Journal Form</button>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.20/dist/sweetalert2.min.css" />
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.20/dist/sweetalert2.all.min.js"></script>
	<script>
	// Fake user ID (replace with actual user authentication)
	const userId = 1;
	// Array of example questions
	const exampleQuestions = [
		"What is your starting length and girth?",
		"What are your goals for the week?",
		// Add more example questions here
	];

	// Function to create the journal form HTML
	function createJournalFormHtml() {
		let formHtml = '<form id="journalForm">';
		for (let i = 0; i < exampleQuestions.length; i++) {
			formHtml += `
				<label for="question${i + 1}">${exampleQuestions[i]}</label>
				<input type="text" id="question${i + 1}" name="answer${i + 1}" required>
			`;
		}
		formHtml += `
			<!-- Add more questions here -->
		</form>
		`;
		return formHtml;
	}

	// Show the journal form in a SweetAlert when the "Open Journal Form" button is clicked
	document.getElementById('openJournalForm').addEventListener('click', function() {
		Swal.fire({
			title: '<strong>Weekly Journal</strong>',
			icon: 'info',
			html: createJournalFormHtml(),
			showCloseButton: true,
			showCancelButton: false,
			focusConfirm: false,
			confirmButtonText: '<i class="fa fa-thumbs-up"></i> Submit',
			confirmButtonAriaLabel: 'Submit',
			onOpen: () => {
				// Add a click event listener to the form's submit button
				document.getElementById('journalForm').addEventListener('submit', function(event) {
					event.preventDefault();
					// Get form data
					const formData = new FormData(event.target);
					const answers = {};
					// Store answers in an object
					formData.forEach((value, key) => {
						answers[key] = value;
					});
					// Save the answers to the database or any storage of your choice
					saveJournalEntry(userId, answers).then(() => {
						// Close the SweetAlert
						Swal.close();
						// Show success alert
						Swal.fire('Success!', 'Your journal entry has been submitted.', 'success');
					}).catch((error) => {
						// Show error alert
						Swal.fire('Error!', 'There was a problem submitting your journal entry.', 'error');
						console.error(error);
					});
					// Clear form after submission
					event.target.reset();
				});
			}
		});
	});

	function saveJournalEntry(userId, answers) {
		// Simulate saving to a database (replace with actual database integration)
		return new Promise((resolve, reject) => {
			// Simulate server delay
			setTimeout(() => {
				// Create a new JournalEntry record (if needed) with user ID and date
				const entryId = Math.floor(Math.random() * 1000); // Replace with actual entry ID
				const dateSubmitted = new Date().toLocaleDateString(); // Replace with actual date
				// Save answers to the database (replace with actual database call)
				// For simplicity, we will just log the data here instead of saving to a database
				console.log(`User ID: ${userId}`);
				console.log(`Entry ID: ${entryId}`);
				console.log(`Date Submitted: ${dateSubmitted}`);
				console.log('Answers:', answers);
				// Resolve the promise
				resolve();
			}, 1500); // Simulated server delay of 1.5 seconds
		});
	}
	</script>
	<style>
	/* Custom CSS for the journal form */
	.journal-form-container {
		max-width: 400px;
		margin: 0 auto;
	}

	.journal-form-container label {
		display: block;
		font-weight: bold;
		margin-bottom: 5px;
	}

	.journal-form-container input {
		width: 100%;
		height: 30px; /* Adjust the height for smaller inputs */
		margin-bottom: 10px;
	}

	.journal-form-container button {
		display: block;
		width: 100%;
		padding: 10px;
		background-color: #4CAF50;
		color: white;
		border: none;
		cursor: pointer;
	}
	</style>
</body>

</html>
